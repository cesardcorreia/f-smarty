{extends file="template.tpl"} 
{block name="css"}
<style type="text/css">
.form-control:focus {
  border-color: #FF0000;
  box-shadow: inset 10px 0px 0px rgba(255, 0, 2, 0.275), 0 0 6px rgba(255, 0, 0, 0.5);
}
</style>
{/block}
{block name="bread"}
        <h1 class='blink'>
            {if $linhas gt 0}
                <strong>{if $separar.0.missing lt $separar.0.qty}{$separar.0.missing}{else}{$separar.0.qty}{/if}</strong> - <strong>{$separar.0.tipo}{$separar.0.corredor}{$separar.0.prateleira}{$separar.0.altura}{if $separar.0.tipo eq "P"}{$separar.0.profundidade}{/if} {if $separar.0.tipo eq "Z"}- P{$separar.0.palete}{/if}{if $separar.0.corredor eq "T"} <strong><u>P{$separar.0.palete}</u></strong>{/if}</strong> - {$separar.0.id_produto} - <strong>{$separar.0.descricao}</strong>
            <small>(Faltam {$linhasmiss}/{$linhas} picks) <!--(STOCK LOJAS: {$stocktotal.total})--> </small>   
            {if $separar.0.missing lt $separar.0.qty}{assign var="miss" value=$separar.0.missing}{elseif $separar.0.qty eq ""}{assign var="miss" value=$separar.0.missing}{else}{assign var="miss" value=$separar.0.qty}{/if}
            {assign var="resto" value=$miss % $separar.0.multiplo}
            {if $nomultiplo eq 0 && $separar.0.multiplo gt 0 && $resto eq 0}

                
                {if $separar.0.missing lt $separar.0.qty}{$separar.0.missing}{elseif $separar.0.qty eq ""}{$separar.0.missing}{else}{$separar.0.qty}{/if}U / {if $separar.0.missing lt $separar.0.qty}{$separar.0.missing / $separar.0.multiplo}{elseif $separar.0.qty eq ""}{$separar.0.missing / $separar.0.multiplo}{else}{$separar.0.qty / $separar.0.multiplo}{/if} PACK(S)
            {/if}
            {else}
                <strong>PEDIDO FINALIZADO !!</strong>
            {/if}
        </h1>
            <span class="blink"><small>({$pedido.armazem} - <strong>{$pedido.nome} {$pedido.crosspos}</strong> - {$pedido.carro} - <strong><span id='caixas'>{$caixas}</span> CAIXA(S))</strong></small></span>

            <ol class="breadcrumb hidden-xs">
                <li><h1><i class="fa fa-dashboard {if $percentagem_velocidade lt 0.9}text-danger{else if $percentagem_velocidade lt 1}text-warning{else}text-success{/if}"></i> </h1></li>
            </ol>
        <ol class="breadcrumb hidden-xs">
            
            <li><a href="/"><i class="fa fa-dashboard"></i> Home</a></li>
            <li class="active">Picking</li>
        </ol>
<div id="spinner" class="spinner" style="display:none;">
    <img id="img-spinner" src="/img/ajax-loader1.gif" alt="Loading"/>
    
</div>
        
<div id="spinner2" class="spinner" style="display:none;">
    <img id="img-spinner2" src="/img/ajax-loader-circle-thickbox-red.gif" alt="Loading"/>
    
</div>
        
{/block}
{block name="main"}


                    <!-- Main row -->
                    <div class="row">
                        <!-- left column -->
                        <div class="col-md-12">
                            <div class="box box-primary">
                                
                                    <div class="box-body" id="specialstuff">

                                        

{if $pedido.zonas eq "ZO"}
    <script>
    $( document ).ready(function()     {
        $( "#posicao" ).val("P921");
        $( "#carro" ).val("{$pedido.carro}");
        
        $("#carro").focusin(function() {
            if ($( "#carro" ).val() !=='') {
                $("#pick").click();
            }

        });

    });
    
 
    </script>
{/if}
                                        
                                        
                                
                                   
<!--TAB por_produto-->
<form action="" rola="form" id="continuar-produto" method="post" class="form-horizontal" autocomplete="false">
<input type="hidden" name="one-pick" class="form-control input" value='1'/>
<input type="hidden" name="pedido" class="form-control input" value='{$pedido.id_pedido}'/>
<input type="hidden" name="ordem" class="form-control input" value='{$separar.0.ordenacao}'/>
<input type="hidden" name="linha" class="form-control input" value='{$separar.0.linha}'/>
<input type="hidden" name="qtypos" class="form-control input" value='{$separar.0.qty}'/>
<input type="hidden" name="sproduto" id="sproduto" class="form-control input" value='{$separar.0.id_produto}'/>
<input type="hidden" name="sqty"  id="sqty" class="form-control input" value='{if $separar.0.missing lt $separar.0.qty}{$separar.0.missing}{elseif $separar.0.qty eq ""}{$separar.0.missing}{else}{$separar.0.qty}{/if}'/>
<input type="hidden" name="nomultiplo"  id="nomultiplo" class="form-control input" value='{$nomultiplo}'/>
<input type="hidden" name="multipos"  id="multipos" class="form-control input" value='{if $separar.0.tipo eq "Z" || $separar.0.corredor eq "T"}1{else}0{/if}'/>
<input type="hidden" name="pospedida"  id="pospedida" class="form-control input" value='{if $separar.0.tipo eq "Z" || $separar.0.corredor eq "T"}P{$separar.0.palete}{else}{$separar.0.tipo}{$separar.0.corredor}{$separar.0.prateleira}{$separar.0.altura}{if $separar.0.tipo eq "P"}{$separar.0.profundidade}{/if}{/if}'/>
{if $separar.0.id_produto neq ""} 
<div class="row">
    <div class="col-xs-6 col-sm-3 col-xs-12">
        <div class="control-group">
            <label class="control-label" for="posicao"><span class="required">* </span>{if $separar.0.tipo eq "Z" || $separar.0.corredor eq "T"}Palete{else}Posição{/if}: <!--<img src="/barcode.php?text={$separar.0.tipo}{$separar.0.corredor}{$separar.0.prateleira}{$separar.0.altura}{if $separar.0.tipo eq "P"}{$separar.0.profundidade}{/if}&codetype=code128&size=11" alt="testing" />--></label>
            <div class="controls input-group-lg">
                <input type="text" name="posicao" class="form-control input continuarin-produto" id="posicao" autocomplete="off" />
                
            </div>
        </div>
    </div>
            
    
            
    <div class="col-xs-6 col-sm-3 col-xs-12">
        <div class="control-group">
            <label class="control-label" for="posicao"><span class="required">* </span>{if $separar.0.tipo eq "Z" || $separar.0.corredor eq "T"}Palete{else}Posição{/if}:</label>
            <div class="controls input-group-lg">
                <input type="text" name="posicao" value="{$separar.0.tipo}{$separar.0.corredor}{$separar.0.prateleira}{$separar.0.altura}{if $separar.0.tipo eq "P"}{$separar.0.profundidade}{/if} - ({$separar.0.qty}) {if $separar.0.tipo eq "Z" || $separar.0.corredor eq "T"}- P{$separar.0.palete}{/if}" class="form-control input" disabled="1" />
            </div>
        </div>
    </div>
    
    
    
            
    <div class="col-sm-6 col-xs-12">
        <div class="control-group">
            <label class="control-label" for="id_produto"><span class="required"></span>ID: <!--<img src="/barcode.php?text={$separar.0.id_produto}&codetype=code128&size=11" alt="testing" />--></label>
            <div class="input-group input-group-lg">

                <input type="text" name="id_produto" class="form-control input continuarin-produto" required id="id_produto" autocomplete="off"/>
                <div class="input-group-btn">
                    <button type="button" class="btn btn-primary"  data-toggle="modal" data-target="#barcode-modal"><i class="fa fa-barcode"></i></button>
                </div>
            </div>
        </div>
    </div>
            </div>
            <div class="row">
    <div class="col-sm-6">
        <div class="control-group">
            <label class="control-label" for="descricao"><span class="required">* </span>Descricao:</label>
            <div class="controls input-group-lg">
                <input type="text" name="descricao" class="form-control input" disabled="1" id="descricao" value="{$separar.0.descricao}"/>
            </div>
        </div>
    </div>
    
    <div class="col-sm-2 col-xs-6">
        <div class="control-group">
            <label class="control-label" for="qty"><span class="required"></span>QTY: <!--<img src="/barcode.php?text={if $separar.0.missing lt $separar.0.qty}{$separar.0.missing}{else}{$separar.0.qty}{/if}&codetype=code128&size=11" alt="testing" />--></label>
            <div class="controls input-group-lg">

                <input type="tel" name="qty" class="form-control input continuarin-produto" required id="qty"/>

            </div>
        </div>
    </div>
    <div class="col-sm-2 col-xs-6">
        <div class="control-group">
             <label class="control-label">Retirar:</label>
            <div class="controls input-group-lg">
            <input type="tel" class="form-control input" disabled="1" value="{if $separar.0.missing lt $separar.0.qty}{$separar.0.missing}{elseif $separar.0.qty eq ""}{$separar.0.missing}{else}{$separar.0.qty}{/if}" style="font-weight: bold;"/>
            </div>
        </div>
    </div>
            
    <div class="col-sm-2 col-xs-12">
        <div class="control-group {$pedido.carro_class}">
            <label class="control-label" for="carro"><span class="required"> </span>Carro: <!--<img src="/barcode.php?text={$pedido.carro}&codetype=code128&size=11" alt="{$pedido.carro}" />--></label>
            <div class="controls input-group-lg">
                <input type="text" name="carro" class="form-control input continuarin-produto" id="carro" autocomplete="off" />
                
            </div>
        </div>
    </div>
            </div>
</div>

<div class="row">
    

    
    
    
    
    
</div>
{/if}
<div class="row" >

<div class="col-sm-12">

<br/>
<div class="row" >

    <div class="col-sm-3 col-xs-12">
        {if $oncar.items gt 0}
            <a href="/picking/empty-car/{$pedido.id_pedido}" class="btn-block btn-lg btn btn-warning" role="button">ESVAZIAR CARRO ({$oncar.items}) <i class="fa fa-fw fa-shopping-cart"></i> </a>
        {elseif $pedido.tipopedido eq "MANUAL" || $pedido.tipopedido eq "ENC"}
            
            {if ($separar.0.tipo neq "E" && $separar.0.tipo neq "") && $pedido.armazem eq "920"}
                <a href="#" class="btn-block btn-lg btn btn-warning" role="button">PEDIDO PRIORITARIO <i class="fa fa-fw fa-bolt"></i> </a>
            {else}
                <a href="/picking/on-hold/{$pedido.id_pedido}" class="btn-block btn-lg btn btn-danger" role="button">EM ESPERA <i class="fa fa-fw fa-clock-o"></i> </a>
            {/if}
        {/if}
    </div>
    <div class="col-sm-7 col-xs-12">
        {if $linhas gt 0}
        <a href="?finalizar=1" class="btn-block btn-lg btn btn-success" id="pick" role="button">SEGUINTE <i class="fa fa-fw fa-arrow-right"></i><i class="fa fa-fw fa-arrow-right"></i> </a>
        {/if}
        {if $linhas eq 0 && $oncar.items eq 0}
        <a href="/picking/ver/{$pedido.id_pedido}/?accao=fechar" class="btn-block btn-lg btn btn-warning" role="button">ENCERRAR PEDIDO <i class="fa fa-fw fa-times"></i> </a>
        {/if}
    </div>
    <div class="col-sm-2 col-xs-12">
        {if $linhas gt 0}
                <a href="/picking/change-car/" class="btn-block btn-lg btn btn-dropbox" role="button">MUDAR <i class="fa fa-fw fa-share-square-o"></i> <i class="fa fa-fw fa-shopping-cart"></i> </a> 
        {elseif $linhas eq 0 && $oncar.items eq 0}
            
        {/if}
       
        
    </div>
</div>
{if $linhas gt 0}
<center><small>SEGUINTE: {$separar.1.id_produto} - <strong>{$separar.1.descricao}</strong> - {$separar.1.tipo}{$separar.1.corredor}{$separar.1.prateleira}{$separar.1.altura}{if $separar.1.tipo eq "P"}{$separar.1.profundidade}{/if}</small></center>
{/if}
{if $separar.0.corredor neq "A" && $separar.0.corredor neq "B" && $separar.0.corredor neq "C" && $separar.0.corredor neq "F" && $separar.0.tipo eq "P"}
<center><small>
        <a href="/picking/preparar-pedido/{$pedido.id_pedido}/?posicao={$separar.0.ordenacao - 1}&skip={$skip}&produto={$separar.0.id_produto}">SALTAR PICK</a>
    </small></center>
{elseif $separar.0.tipo neq "P"}
    {if $pedido.armazem eq "800"}
        <br/><br/>
        <center><small>
        <a class="btn btn btn btn-danger" href="/picking/preparar-pedido/{$pedido.id_pedido}/?accao=anular&qty={$separar.0.missing}&prod={$separar.0.id_produto}">Anular {$separar.0.missing} UNID</a>
        &nbsp;&nbsp;&nbsp;<a class="btn btn btn btn-success" href="/picking/preparar-pedido/{$pedido.id_pedido}/?accao=aumentar&qty=1&prod={$separar.0.id_produto}">Aumentar 1 UNID</a>
        </small></center>
    {else}
        <center><small>
        <a href="/picking/preparar-pedido/{$pedido.id_pedido}/?posicao={$separar.0.ordenacao + 1}">SALTAR PICK</a>
        </small></center>
    {/if}
    
{/if}
</div>

</div>
            
            
            
<div class="row">
    <div class="col-sm-12 datatable">

<br/>
    <table class="table table-striped">
        <tr>
            <th style="width: 70px">#</th>
            <th class="hidden-xs">Descricao</th>
            <th style="width: 200px">Data</th>
            <th style="width: 80px">Retirado</th>
            <th class="hidden-xs" style="width: 80px">Adicionado</th>
            <th style="width: 40px">Qty</th>
            
        </tr>
        {**$linhas|@debug_print_var**}
        {foreach key=id item=linha from=$separado}
        <tr id="linha-{$linha.nr_linha}">
            <td>{$linha.id_artigo}</td>
            <td class="hidden-xs">{$linha.descricao}</td>
            <td>{$linha.data_hora}</td>
            <td>{$linha.retirado}</td>
            <td class="hidden-xs">{$linha.adicionado}</td>
            
            <td>{$linha.qty}</td>
            
        </tr>
{foreachelse}
{/foreach}

    </table>
    </div>                                               

</div>
</form>
<!--/TAB por_produto-->
                                    
                            

                            

                            
                            
                            
                            
                            
                            
                            
                            
                            <hr/>
<div class="row">
    <div class="col-sm-12 datatable">




</div>                                               

    </div>
                            
                            
                            
                            
                            
                            
                            
                            
 
                                        </div>
                                        





<div class="modal fade" id="barcode-modal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title" id="myModalLabel">Pesquisar Artigo</h4>
            </div>
            <div class="modal-body">
                
                <div class="control-group">
                    <label class="control-label" for="modal-nome"><span class="required">* </span>Nome:</label>
                    <div class="input-group input-group">
                        <input type="text" name="modal-nome" class="form-control input" id="modal-nome"/>
                        <div class="input-group-btn">
                            <button type="button" class="btn btn-primary" id="modal-search"><i class="fa fa-fw fa-search-plus"></i></button>
                        </div>
                    </div>
                    <div class='row'><div id="search-results" class='col-sm-12 centered search-results'></div></div>
                    
                    
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
        </div>
    </div>
  </div>
</div>

<div class="modal fade" id="barcode2-modal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title" id="myModalLabel">Posições Disponiveis</h4>
            </div>
            <div class="modal-body">
                
                
                    
                    <div class='row'><div id="search-results" class='col-sm-12 centered search-results'></div></div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
        </div>
    </div>
  </div>
</div>

<div class="modal fade" id="confirma-modal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title" id="myModalLabel">Confirma Produtos</h4>
            </div>
            <div class="modal-body">
                
                
                    
                    <div class='row'><div id="search-results" class='col-sm-12 centered search-results'></div></div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
        </div>
    </div>
  </div>
</div>

<div class="modal fade" id="message-modal" tabindex="-1" role="dialog" aria-labelledby="basicModal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title" id="message-title">---</h4>
            </div>
            <div class="modal-body" id="message-texto">
                
            </div>
            <div class="modal-footer " id="message-fundo">
                <button type="button" class="btn btn-default" data-dismiss="modal">Fechar</button>
                
            </div>
    </div>
  </div>
</div>


 

                                    </div></div>
                        </div><!-- right col -->
                    </div><!-- /.row (main row) -->
                    
                    <script src="/js/preparar-pedido.js?v=1" type="text/javascript"></script>
                   {** <script src="/js/fullscreen.js" type="text/javascript"></script>
<script type="text/javascript">
    jQuery(document).ready(function() {		
        //alert(window.fullScreenApi.supportsFullScreen);
        fsElement = document.getElementById('specialstuff'),
        window.fullScreenApi.requestFullScreen(fsElement);
    });
</script>**}

<script type="text/javascript">
    function parseJSONResponse(resultado) {
        var form = document.getElementById("ajax");
        if(resultado.status == "OK") {
            var result = resultado.results[0];
            form.text.value = result.text;
            var url = "/entradas/continuar/" + result.id + "/";    
            $(location).attr('href',url);
        }
        else
            form.text.value = "N/A";
 
        document.getElementById("text").style.display = "block";
    }
</script>
{/block}


{block name="title"}Pluricosmética - Dashboard{/block} 
{block name="header"}

{/block} 
